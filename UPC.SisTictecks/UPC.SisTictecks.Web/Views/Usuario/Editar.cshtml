@model UPC.SisTictecks.EL.UsuarioEN

@{
    ViewBag.Title = "Editar";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Usuario</h2>


@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()
    
    <div class="form-horizontal">
        <h4>Editar</h4>
        <hr />
        @Html.ValidationSummary()
        @Html.HiddenFor(model => model.Codigo)

        @*<div class="form-group">
            @Html.LabelFor(model => model.Codigo, new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.Codigo)                
            </div>
        </div>*@

        <div class="form-group">
            @Html.LabelFor(model => model.Nombres, new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.Nombres)                
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.Apellidos, new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.Apellidos)                
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.Usuario, new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.Usuario)                
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.Pass, new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.Pass)                
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.Estado, new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.Estado)                
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.Dni, new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.Dni)
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.Perfil.Descripcion, new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @*@Html.DropDownListFor(model => model.Perfil.Codigo, ViewBag.ListaPerfiles as SelectList)*@
                <select class="frm_txt" name="cboPerfiles" id="cboPerfiles" style="width:150px"></select>
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.Telefono, new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.Telefono)
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.Correo, new { @class = "control-label col-md-2" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.Correo)
            </div>
        </div>

        <div class="form-group">
            <div class="col-md-offset-2 col-md-10">
                <input type="submit" value="Grabar" class="btn btn-default" />
            </div>
        </div>
    </div>
}

<div>
    @Html.ActionLink("Volver", "Index")
</div>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")

    <script>
        $(document).ready(function () {

            cargarPerfiles();

        });

        function cargarPerfiles() {
            $.get('@Url.Action("ListaPerfiles", "Usuario")')
            .done(function (data) {
                $('#cboPerfiles').append('<option value="0"></option>');
                $.each(data, function (i, row) {
                    var $option = $('<option>');
                    $option.val(row.Codigo);
                    $option.html(row.Descripcion);
                    $('#cboPerfiles').append($option);                    
                    $("#cboPerfiles option").filter(function () {                        
                        return $(this).val() == "@(Model.Perfil.Codigo)";
                    }).prop('selected', true);

                })
            })
            .fail(function (data) {
                console.log('error');
            });

        }

    </script>
}
